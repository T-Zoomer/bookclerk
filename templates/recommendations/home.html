{% extends 'recommendations/base.html' %}
{% load static %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Main Form Card -->
    <div class="bg-cream rounded-xl shadow-2xl border border-gold/20 p-10 mb-12 relative overflow-hidden">
        <!-- Decorative paper texture overlay -->
        <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: url('data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22 viewBox=%220 0 60 60%22><g fill=%22%238b4513%22><path d=%22M0 0h60v60H0z%22 opacity=%220.02%22/><circle cx=%2210%22 cy=%2210%22 r=%220.8%22 opacity=%220.1%22/><circle cx=%2250%22 cy=%2250%22 r=%220.6%22 opacity=%220.08%22/></g></svg>');"></div>
        
        <!-- Vintage corners -->
        <div class="absolute top-4 left-4 w-6 h-6 border-l-2 border-t-2 border-gold/40"></div>
        <div class="absolute top-4 right-4 w-6 h-6 border-r-2 border-t-2 border-gold/40"></div>
        <div class="absolute bottom-4 left-4 w-6 h-6 border-l-2 border-b-2 border-gold/40"></div>
        <div class="absolute bottom-4 right-4 w-6 h-6 border-r-2 border-b-2 border-gold/40"></div>
        
        <div class="relative z-10">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <img src="{% static 'BookClerk Logo.png' %}" alt="BookClerk Logo" class="w-32 h-32 object-contain">
                </div>
                <div class="flex-1 text-center">
                    <h2 class="text-4xl font-serif font-semibold text-ink mb-3">What Do You Want to Read?</h2>
                </div>
            </div>
            
            <form method="post" action="{% url 'get_recommendations' %}" class="space-y-6" id="recommendation-form">
                {% csrf_token %}
                <div>
                    
                    <div class="relative">
                        <textarea 
                            id="preferences" 
                            name="preferences" 
                            rows="2" 
                            class="w-full px-6 py-4 border-2 border-gold/30 rounded-lg shadow-inner bg-parchment/50 focus:outline-none focus:ring-2 focus:ring-leather focus:border-leather transition-colors duration-200 font-serif text-lg text-ink placeholder-leather/50 resize-none overflow-hidden"
                            placeholder=""
                            data-placeholder="Example: I like science fiction with strong characters, mysteries set in small towns, or psychology books. Include genres, authors, or specific books you've enjoyed."
                            required
                            oninput="autoResize(this)"
                        ></textarea>
                        <!-- Decorative quill icon -->
                        <div class="absolute bottom-3 right-3 text-gold/40 pointer-events-none">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"/>
                                <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <button 
                    type="submit" 
                    id="submit-btn"
                </button>
            </form>
        </div>
    </div>

    {% if recent_requests %}
    <!-- Recent Requests Section -->
    <div class="bg-cream/70 rounded-xl shadow-lg border border-gold/30 p-8 relative">
        <!-- Decorative header -->
        <div class="text-center mb-6">
            <h3 class="text-3xl font-serif font-semibold text-ink mb-2">Recent Requests</h3>
        </div>
        
        <div class="space-y-4">
            {% for request in recent_requests %}
            <div class="bg-parchment/80 rounded-lg border-l-4 border-leather shadow-sm p-5 hover:shadow-md transition-shadow duration-200 group">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-sm text-leather/70 font-serif">{{ request.created_at|date:"M d, Y" }}</span>
                            <span class="text-gold">â€¢</span>
                            <span class="text-sm text-leather/70 font-serif">{{ request.created_at|date:"H:i" }}</span>
                        </div>
                        <p class="text-lg text-ink font-serif leading-relaxed mb-3">"{{ request.user_preferences|truncatewords:15 }}"</p>
                        <a href="{% url 'view_recommendations' request.id %}" class="inline-flex items-center space-x-2 text-burgundy hover:text-leather transition-colors duration-200 text-base font-medium group-hover:translate-x-1 transform transition-transform">
                            <span>View recommendations</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                            </svg>
                        </a>
                    </div>
                    <div class="text-2xl opacity-60 group-hover:opacity-80 transition-opacity">ðŸ“–</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
